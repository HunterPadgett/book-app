<!-- input and button -->
<div class="container mx-auto flex items-center justify-center p-4">
 <input
  type="text"
  placeholder="Book title"
  class="input-bordered input-secondary input m-2 w-full max-w-xs text-lg"
 />
 <button class="btn-secondary btn m-2 max-w-xs text-lg" id="add-book-btn"
  >Add</button
 >
</div>

<!-- book container -->
<div
 class="container mx-auto grid grid-cols-1 gap-8 p-4 md:grid-cols-2"
 id="books-read"
>
 <!-- book  -->
</div>

<script>
 async function addBook() {
  const title = document.querySelector("input");
  const bookSection = document.querySelector("#books-read");
  const convertedTitle = title.value
   .split(" ")
   .join("+")
   .toLocaleLowerCase()
   .trim();
  let coverUrl = ``;
  const month = new Date().getMonth() + 1;
  const day = new Date().getDate();
  const year = new Date().getFullYear();
  const dateAdded = `${month}/${day}/${year}`;
  console.log(dateAdded);

  try {
   // first fetch for book title
   const response = await fetch(
    `https://openlibrary.org/search.json?q=${convertedTitle}&limit=10`
   );
   const data = await response.json();
   const bookTitle = data.docs[0].title;
   const isbn = data.docs[0].isbn[0];
   const cover = data.docs[0].cover_i;
   console.log(data);
   //  second fetch for ISBN
   const postsResponse = await fetch(
    `https://openlibrary.org/isbn/${isbn}.json`
   );
   const isbnData = await postsResponse.json();
   console.log(isbnData);
   if (cover) {
    coverUrl = `https://covers.openlibrary.org/b/id/${cover}-M.jpg`;
   } else {
    coverUrl = `https://covers.openlibrary.org/b/id/${isbnData.covers[0]}-M.jpg`;
    console.log(coverUrl);
   }

   const html = `
    <div
    class="card card-side mx-auto max-w-lg border-2 bg-primary-content border-base-content shadow-lg shadow-neutral-600">
    <figure>
      <img class="max-w-xs" src="${coverUrl}" alt="${coverUrl}" />
    </figure>
    <div class="card-body p-4 text-center">
      <h2 class="card-title text-2xl mx-auto">${bookTitle}</h2>
      <p>Date added: ${dateAdded}</p>
    </div>
    </div>
   `;

   bookSection.insertAdjacentHTML("beforeend", html);
   title.value = "";
   //  error handling
  } catch (error) {
   console.error(error);
  }
 }

 document.querySelector("#add-book-btn").addEventListener("click", addBook);
</script>
